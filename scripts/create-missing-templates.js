#!/usr/bin/env node

/**
 * Create missing English and Spanish templates for all documents
 */

const fs = require('fs');
const path = require('path');

console.log('ğŸ“ Creating Missing Templates...\n');

const templatesDir = path.join(__dirname, '../public/templates');
const enTemplatesDir = path.join(templatesDir, 'en');
const esTemplatesDir = path.join(templatesDir, 'es');
const usDocsDir = path.join(__dirname, '../src/lib/documents/us');

// Get list of all document directories
const documentDirs = fs.readdirSync(usDocsDir)
  .filter(item => {
    const itemPath = path.join(usDocsDir, item);
    return fs.statSync(itemPath).isDirectory();
  })
  .sort();

console.log(`Found ${documentDirs.length} document directories to check...`);

// Template content generators
function generateEnglishTemplate(docId, docName, description) {
  return `# ${docName}

**Professional ${docName} Template**

${description}

---

## Document Information

**Document Type**: ${docName}  
**Jurisdiction**: United States  
**Language**: English  
**Last Updated**: ${new Date().toLocaleDateString()}

---

## Key Sections

### 1. Parties Information
- **First Party**: {{party1Name}}
- **Address**: {{party1Address}}
- **Second Party**: {{party2Name}}  
- **Address**: {{party2Address}}

### 2. Terms and Conditions
{{terms}}

### 3. Effective Date
This agreement shall be effective as of {{effectiveDate}}.

### 4. Additional Provisions
{{additionalProvisions}}

---

## Legal Disclaimer

This template is provided for informational purposes only and does not constitute legal advice. Please consult with a qualified attorney for legal guidance specific to your situation.

---

**Generated by 123LegalDoc**  
*Professional Legal Documents Made Simple*
`;
}

function generateSpanishTemplate(docId, docName, description) {
  return `# ${docName}

**Plantilla Profesional de ${docName}**

${description}

---

## InformaciÃ³n del Documento

**Tipo de Documento**: ${docName}  
**JurisdicciÃ³n**: Estados Unidos  
**Idioma**: EspaÃ±ol  
**Ãšltima ActualizaciÃ³n**: ${new Date().toLocaleDateString()}

---

## Secciones Principales

### 1. InformaciÃ³n de las Partes
- **Primera Parte**: {{party1Name}}
- **DirecciÃ³n**: {{party1Address}}
- **Segunda Parte**: {{party2Name}}  
- **DirecciÃ³n**: {{party2Address}}

### 2. TÃ©rminos y Condiciones
{{terms}}

### 3. Fecha Efectiva
Este acuerdo serÃ¡ efectivo a partir del {{effectiveDate}}.

### 4. Disposiciones Adicionales
{{additionalProvisions}}

---

## Descargo de Responsabilidad Legal

Esta plantilla se proporciona Ãºnicamente con fines informativos y no constituye asesoramiento legal. Consulte con un abogado calificado para obtener orientaciÃ³n legal especÃ­fica para su situaciÃ³n.

---

**Generado por 123LegalDoc**  
*Documentos Legales Profesionales Hechos Simples*
`;
}

// Document name mappings for better templates
const documentNames = {
  'affidavit': { en: 'General Affidavit', es: 'DeclaraciÃ³n Jurada General' },
  'affidavit-general': { en: 'General Affidavit', es: 'DeclaraciÃ³n Jurada General' },
  'articles-of-incorporation': { en: 'Articles of Incorporation', es: 'ArtÃ­culos de IncorporaciÃ³n' },
  'articles-of-incorporation-biz': { en: 'Business Articles of Incorporation', es: 'ArtÃ­culos de IncorporaciÃ³n Comercial' },
  'boat-bill-of-sale': { en: 'Boat Bill of Sale', es: 'Contrato de Compraventa de EmbarcaciÃ³n' },
  'child-custody-agreement': { en: 'Child Custody Agreement', es: 'Acuerdo de Custodia de Menores' },
  'child-medical-consent': { en: 'Child Medical Consent', es: 'Consentimiento MÃ©dico Infantil' },
  'commercial-lease-agreement': { en: 'Commercial Lease Agreement', es: 'Contrato de Arrendamiento Comercial' },
  'consignment-agreement': { en: 'Consignment Agreement', es: 'Acuerdo de ConsignaciÃ³n' },
  'copyright-assignment': { en: 'Copyright Assignment', es: 'CesiÃ³n de Derechos de Autor' },
  'demand-letter': { en: 'Demand Letter', es: 'Carta de Demanda' },
  'demand-letter-payment': { en: 'Payment Demand Letter', es: 'Carta de Demanda de Pago' },
  'divorce-settlement': { en: 'Divorce Settlement', es: 'Acuerdo de Divorcio' },
  'divorce-settlement-agreement': { en: 'Divorce Settlement Agreement', es: 'Acuerdo de LiquidaciÃ³n de Divorcio' },
  'employment-contract': { en: 'Employment Contract', es: 'Contrato de Empleo' },
  'employment-offer-letter': { en: 'Employment Offer Letter', es: 'Carta de Oferta de Empleo' },
  'employment-termination-letter': { en: 'Employment Termination Letter', es: 'Carta de TerminaciÃ³n de Empleo' },
  'eviction-notice': { en: 'Eviction Notice', es: 'Aviso de Desalojo' },
  'general-inquiry': { en: 'General Inquiry', es: 'Consulta General' },
  'healthcare-power-of-attorney': { en: 'Healthcare Power of Attorney', es: 'Poder Notarial de Salud' },
  'independent-contractor-agreement': { en: 'Independent Contractor Agreement', es: 'Acuerdo de Contratista Independiente' },
  'invoice': { en: 'Invoice', es: 'Factura' },
  'last-will-testament': { en: 'Last Will and Testament', es: 'Ãšltimo Testamento' },
  'lease-agreement': { en: 'Lease Agreement', es: 'Contrato de Arrendamiento' },
  'licensing-agreement': { en: 'Licensing Agreement', es: 'Acuerdo de Licencia' },
  'living-trust': { en: 'Living Trust', es: 'Fideicomiso en Vida' },
  'living-will': { en: 'Living Will', es: 'Testamento en Vida' },
  'llc-operating-agreement': { en: 'LLC Operating Agreement', es: 'Acuerdo Operativo de LLC' },
  'loan-agreement': { en: 'Loan Agreement', es: 'Contrato de PrÃ©stamo' },
  'medical-consent': { en: 'Medical Consent', es: 'Consentimiento MÃ©dico' },
  'nda': { en: 'Non-Disclosure Agreement', es: 'Acuerdo de Confidencialidad' },
  'non-compete-agreement': { en: 'Non-Compete Agreement', es: 'Acuerdo de No Competencia' },
  'non-disclosure-agreement': { en: 'Non-Disclosure Agreement', es: 'Acuerdo de No DivulgaciÃ³n' },
  'offer-letter': { en: 'Offer Letter', es: 'Carta de Oferta' },
  'operating-agreement': { en: 'Operating Agreement', es: 'Acuerdo Operativo' },
  'partnership-agreement': { en: 'Partnership Agreement', es: 'Acuerdo de Sociedad' },
  'power-of-attorney': { en: 'Power of Attorney', es: 'Poder Notarial' },
  'prenuptial-agreement': { en: 'Prenuptial Agreement', es: 'Acuerdo Prenupcial' },
  'promissory-note': { en: 'Promissory Note', es: 'PagarÃ©' },
  'property-deed': { en: 'Property Deed', es: 'Escritura de Propiedad' },
  'purchase-agreement': { en: 'Purchase Agreement', es: 'Acuerdo de Compra' },
  'quitclaim-deed': { en: 'Quitclaim Deed', es: 'Escritura de Renuncia' },
  'rental-agreement': { en: 'Rental Agreement', es: 'Contrato de Alquiler' },
  'residential-lease-agreement': { en: 'Residential Lease Agreement', es: 'Contrato de Arrendamiento Residencial' },
  'service-agreement': { en: 'Service Agreement', es: 'Acuerdo de Servicios' },
  'severance-agreement': { en: 'Severance Agreement', es: 'Acuerdo de IndemnizaciÃ³n' },
  'termination-letter': { en: 'Termination Letter', es: 'Carta de TerminaciÃ³n' },
  'trademark-assignment': { en: 'Trademark Assignment', es: 'CesiÃ³n de Marca Registrada' },
  'vehicle-bill-of-sale': { en: 'Vehicle Bill of Sale', es: 'Contrato de Compraventa de VehÃ­culo' }
};

const documentDescriptions = {
  'affidavit': { 
    en: 'A sworn statement of facts made under oath for legal proceedings.',
    es: 'Una declaraciÃ³n jurada de hechos hecha bajo juramento para procedimientos legales.'
  },
  'affidavit-general': { 
    en: 'A general sworn statement document for various legal purposes.',
    es: 'Un documento de declaraciÃ³n jurada general para varios propÃ³sitos legales.'
  },
  'articles-of-incorporation': { 
    en: 'Legal document establishing a corporation as a separate legal entity.',
    es: 'Documento legal que establece una corporaciÃ³n como entidad legal separada.'
  },
  // Add more descriptions as needed - using generic fallback for now
};

let createdCount = 0;
let skippedCount = 0;

// Process each document directory
documentDirs.forEach(dir => {
  const enTemplatePath = path.join(enTemplatesDir, `${dir}.md`);
  const esTemplatePath = path.join(esTemplatesDir, `${dir}.md`);
  
  const hasEnTemplate = fs.existsSync(enTemplatePath);
  const hasEsTemplate = fs.existsSync(esTemplatePath);
  
  const docInfo = documentNames[dir] || { 
    en: dir.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
    es: dir.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
  };
  
  const docDesc = documentDescriptions[dir] || {
    en: `Professional legal document template for ${docInfo.en.toLowerCase()}.`,
    es: `Plantilla de documento legal profesional para ${docInfo.es.toLowerCase()}.`
  };

  let created = false;

  // Create English template if missing
  if (!hasEnTemplate) {
    const content = generateEnglishTemplate(dir, docInfo.en, docDesc.en);
    fs.writeFileSync(enTemplatePath, content);
    console.log(`âœ… Created EN template: ${dir}.md`);
    created = true;
  }

  // Create Spanish template if missing
  if (!hasEsTemplate) {
    const content = generateSpanishTemplate(dir, docInfo.es, docDesc.es);
    fs.writeFileSync(esTemplatePath, content);
    console.log(`âœ… Created ES template: ${dir}.md`);
    created = true;
  }

  if (created) {
    createdCount++;
  } else {
    skippedCount++;
  }
});

console.log(`\nğŸ¯ Template Creation Summary:`);
console.log(`   âœ… Documents with new templates: ${createdCount}`);
console.log(`   â­ï¸  Documents already complete: ${skippedCount}`);
console.log(`   ğŸ“„ Total documents: ${documentDirs.length}`);

// Verify completion
const finalEnCount = fs.readdirSync(enTemplatesDir).filter(f => f.endsWith('.md')).length;
const finalEsCount = fs.readdirSync(esTemplatesDir).filter(f => f.endsWith('.md')).length;

console.log(`\nğŸ“Š Final Template Count:`);
console.log(`   ğŸ‡ºğŸ‡¸ English templates: ${finalEnCount}`);
console.log(`   ğŸ‡ªğŸ‡¸ Spanish templates: ${finalEsCount}`);

if (finalEnCount >= documentDirs.length && finalEsCount >= documentDirs.length) {
  console.log(`\nğŸ‰ SUCCESS! All ${documentDirs.length} documents now have both English and Spanish templates!`);
} else {
  console.log(`\nâš ï¸  Some templates may still be missing. Please review the output above.`);
}

console.log(`\nâœ¨ Template creation complete!`);